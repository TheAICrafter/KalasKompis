<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>KalasKollen ‚Äì Barnkalasplaneraren</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            kalasbg: '#FAF7F2',
            kalasblue: '#005DFF',
            kalasyellow: '#FFD43B',
            kalasmint: '#A8E6CF',
            kalascoral: '#FF6F61',
          },
          fontFamily: {
            'poppins': ['Poppins', 'sans-serif'],
            'inter': ['Inter', 'sans-serif'],
          }
        }
      }
    }
  </script>
  <style>
    html, body { min-height: 100%; background: #FAF7F2; font-family: 'Inter', sans-serif; }
    .kalas-btn { transition: transform 0.17s, box-shadow 0.17s; box-shadow: 0 2px 8px rgba(0,93,255,0.07);}
    .kalas-btn:hover { transform: scale(1.06) translateY(-2px); box-shadow: 0 6px 20px rgba(0,93,255,0.16);}
    .kalas-theme-card {
      transition: box-shadow 0.18s, transform 0.18s, border 0.18s, background 0.18s;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 18px 0 rgba(0,93,255,0.11), 0 1.5px 4px 0 #FFD43B;
      border: 2px solid #A8E6CF;
      background: linear-gradient(110deg, #fff 60%, #A8E6CF22 100%);
    }
    .kalas-theme-card:hover:not(.locked), .kalas-theme-card.selected {
      box-shadow: 0 8px 32px 0 rgba(0,93,255,0.17), 0 1.5px 4px 0 #FFD43B;
      border-color: #005DFF;
      z-index: 2;
      background: #f0f8ff;
    }
    .locked { opacity: 0.55; pointer-events: auto; cursor: not-allowed; border-color: #FFD43B; }
    .kalas-checkbox:checked + span { text-decoration: line-through; color: #A8E6CF; }
    input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0;}
    input[type="number"] { -moz-appearance: textfield;}
    input:focus, select:focus { outline: 2px solid #005DFF !important; }
    .kalas-invite { white-space: pre-line; background: #FAF7F2; border-radius: 1rem; border: 1.5px dashed #005DFF; padding: 1rem;}
    .loading-spinner {
      border: 6px solid #FFD43B;
      border-top: 6px solid #005DFF;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      animation: spin 1.1s linear infinite;
      margin: 0 auto 1.5rem auto;
    }
    @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
    .fade-in { animation: fadeIn 0.7s cubic-bezier(.4,0,.2,1) both; }
    @keyframes fadeIn { 0% { opacity: 0; } 100% { opacity: 1; } }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center bg-kalasbg">

  <div id="kalas-app" class="w-full max-w-xl mx-auto px-2 py-8 flex flex-col items-center">

    <!-- Header -->
    <header class="w-full flex flex-col items-center mb-6">
      <div class="flex items-center gap-2 mb-2">
        <span class="text-3xl">üéà</span>
        <h1 class="font-poppins text-3xl font-semibold text-kalasblue tracking-tight drop-shadow" style="letter-spacing:-1px;">KalasKollen</h1>
        <span class="text-3xl">üéâ</span>
      </div>
      <div class="text-kalascoral font-inter text-base text-center">Planera ditt dr√∂mkalas p√• n√•gra sekunder!</div>
    </header>

    <main id="spa-content" class="w-full"></main>
    <div id="loading-container" class="fixed inset-0 bg-[#FAF7F2ee] flex-col items-center justify-center z-50 hidden">
      <div class="flex flex-col items-center justify-center h-full w-full">
        <div class="loading-spinner"></div>
        <h2 class="font-poppins text-xl text-kalasblue mb-2">Skapar ditt perfekta kalas... ‚ú®</h2>
        <div class="text-base text-gray-600 font-inter">
          <p class="fade-in" style="animation-delay:0.1s">üé® V√§ljer tema...</p>
          <p class="fade-in" style="animation-delay:0.4s">üé≤ Planerar aktiviteter...</p>
          <p class="fade-in" style="animation-delay:0.7s">üßÅ F√∂rbereder meny...</p>
        </div>
      </div>
    </div>
  </div>

<script>
const themeInfo = {
  musik: {
    label: 'Musik',
    name: 'Musikalisk magi',
    description: 'Ett rytmiskt kalas fyllt av musik, dans och kreativitet d√§r barnen f√•r utforska ljud och melodier!',
    emoji: 'üéµ'
  },
  fotboll: {
    label: 'Fotboll',
    name: 'Fotbollsfest',
    description: 'Ett energifyllt kalas med fotbollsaktiviteter och lagk√§nsla!',
    emoji: '‚öΩ'
  },
  prinsessa: {
    label: 'Prinsessa',
    name: 'Magisk prinsessbal',
    description: 'Ett kungligt kalas med glitter, kronor och √§ventyr i sagolandet!',
    emoji: 'üëë'
  },
  hastar: {
    label: 'H√§star',
    name: 'H√§st och ridning',
    description: 'Allt om h√§star, ridning och stalliv!',
    emoji: 'üê¥'
  }
};

const freeThemes = [
  { id: 'musik' },
  { id: 'fotboll' },
  { id: 'prinsessa' },
  { id: 'hastar' }
];

let selectedTheme = null;
let kalasState = {};

function renderForm(main) {
  main.innerHTML = `
    <form id="kalas-form" class="w-full flex flex-col gap-8" autocomplete="off">
      <div class="rounded-2xl p-6 bg-white shadow-kalas border-2 border-kalasmint flex flex-col gap-3 mb-2">
        <label for="age-input" class="font-poppins text-lg text-kalasblue flex items-center gap-2">F√∂delsedagsbarnets √•lder <span class="text-kalascoral text-xl">üéÇ</span></label>
        <input id="age-input" type="number" min="2" max="12" step="1"
          class="w-full text-center py-2 px-4 rounded-xl border-2 border-kalasmint text-xl font-poppins focus:outline-none focus:border-kalasblue transition shadow"
          placeholder="t.ex. 7" required>
      </div>
      <div class="rounded-2xl p-6 bg-white shadow-kalas border-2 border-kalasmint flex flex-col gap-3 mb-2">
        <label for="guests-input" class="font-poppins text-lg text-kalasblue flex items-center gap-2">Antal g√§ster <span class="text-kalascoral text-xl">üßí</span></label>
        <input id="guests-input" type="number" min="1" max="30" step="1"
          class="w-full text-center py-2 px-4 rounded-xl border-2 border-kalasmint text-xl font-poppins focus:outline-none focus:border-kalasblue transition shadow"
          placeholder="t.ex. 10" required>
        <div class="flex gap-2 mt-2 flex-wrap">
          ${[5,8,10,12,15].map(num => `
            <button type="button" data-quick="${num}" class="kalas-btn px-3 py-1 rounded-full bg-kalasyellow text-kalasblue font-poppins font-semibold shadow hover:bg-kalasmint hover:text-kalasblue transition text-base">${num}</button>
          `).join('')}
        </div>
      </div>
      <div class="rounded-2xl p-6 bg-white shadow-kalas border-2 border-kalasmint flex flex-col gap-3 mb-2">
        <label for="place-input" class="font-poppins text-lg text-kalasblue flex items-center gap-2">Plats f√∂r kalaset <span class="text-kalascoral text-xl">üìç</span></label>
        <select id="place-input" class="w-full py-2 px-4 rounded-xl border-2 border-kalasmint text-xl font-poppins focus:outline-none focus:border-kalasblue transition shadow" required>
          <option value="">V√§lj plats...</option>
          <option value="Hemma">Hemma</option>
          <option value="Lekland">Lekland</option>
          <option value="Utomhus">Utomhus</option>
          <option value="Annat">Annat</option>
        </select>
      </div>
      <div class="rounded-2xl p-6 bg-white shadow-kalas border-2 border-kalasmint flex flex-col gap-2">
        <div class="font-poppins text-lg text-kalasblue mb-2 flex items-center gap-2">V√§lj tema <span class="text-kalascoral text-xl">üé®</span></div>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mb-2">
          ${freeThemes.map(theme => `
            <div class="kalas-theme-card bg-white rounded-2xl p-4 flex flex-col items-center justify-center hover:shadow-lg transition group"
              data-theme="${theme.id}" data-type="free" tabindex="0">
              <div class="text-3xl mb-1">${themeInfo[theme.id].emoji}</div>
              <div class="font-poppins font-semibold text-base text-kalasblue">${themeInfo[theme.id].label}</div>
              <div class="text-xs font-inter text-gray-400 mt-1">Gratis</div>
            </div>
          `).join('')}
        </div>
      </div>
      <div class="flex justify-center mt-2">
        <button id="form-next" type="submit" class="kalas-btn px-10 py-3 rounded-full bg-kalasblue text-white font-poppins font-semibold text-lg shadow hover:bg-kalasyellow hover:text-kalasblue transition text-lg flex items-center gap-2">
          <span>Skapa mitt dr√∂mkalas!</span> <span class="text-2xl">üöÄ</span>
        </button>
      </div>
    </form>
  `;

  document.querySelectorAll('[data-quick]').forEach(btn => {
    btn.onclick = (e) => {
      e.preventDefault();
      document.getElementById('guests-input').value = btn.getAttribute('data-quick');
    }
  });

  function updateThemeSelection(themeId, type) {
    document.querySelectorAll('.kalas-theme-card').forEach(card => card.classList.remove('selected'));
    if(themeId) {
      const el = document.querySelector(`.kalas-theme-card[data-theme="${themeId}"]`);
      if(el) el.classList.add('selected');
    }
    selectedTheme = { theme: themeId, type };
  }
  document.querySelectorAll('.kalas-theme-card').forEach(card => {
    card.onclick = () => {
      const type = card.getAttribute('data-type');
      const themeId = card.getAttribute('data-theme');
      updateThemeSelection(themeId, type);
    };
    card.onkeydown = (e) => {
      if(e.key === 'Enter' || e.key === ' ') card.click();
    }
  });

  document.getElementById('kalas-form').onsubmit = (e) => {
    e.preventDefault();
    const age = parseInt(document.getElementById('age-input').value, 10);
    const guests = parseInt(document.getElementById('guests-input').value, 10);
    const place = document.getElementById('place-input').value;
    if(isNaN(age) || age < 2 || age > 12) {
      document.getElementById('age-input').focus();
      return;
    }
    if(isNaN(guests) || guests < 1 || guests > 30) {
      document.getElementById('guests-input').focus();
      return;
    }
    if(!place) {
      document.getElementById('place-input').focus();
      return;
    }
    if(!selectedTheme || !selectedTheme.theme) {
      document.querySelector('.kalas-theme-card').focus();
      return;
    }
    kalasState = { age, guests, place, theme: selectedTheme.theme };
    showLoading(() => renderResult(document.getElementById('spa-content'), kalasState));
  }
}

// --- Snygg laddningssida ---
function showLoading(cb) {
  const loader = document.getElementById('loading-container');
  loader.classList.remove('hidden');
  setTimeout(() => {
    loader.classList.add('hidden');
    cb();
  }, 1800);
}

// --- Dynamisk logik f√∂r lekar, meny, tips, ink√∂p, inbjudan ---
function getKalasData({age, guests, place, theme}) {
  let games = [], menu = [], shopping = [], tips = [], invite = '';
  if(theme === 'musik') {
    if(place === 'Hemma') {
      games = [
        { title: "Dansstopp", desc: "Dans till musik ‚Äì n√§r musiken stannar g√§ller det att st√• still!", instructions: "Spela musik, pausa pl√∂tsligt ‚Äì alla m√•ste frysa. Den som r√∂r sig √•ker ut.", props: "Musikspelare" },
        { title: "Musikquiz", desc: "Gissa l√•tar!", instructions: "Spela korta l√•tsnuttar, l√•t barnen gissa.", props: "Spellista, h√∂gtalare" },
        { title: "Karaoke", desc: "Sjung favoritl√•tar tillsammans!", instructions: "St√§ll fram mikrofon/leksaksmick och l√•t barnen sjunga.", props: "Mikrofon" }
      ];
      menu = ["Fruktspett med noter", "Sockervadd", "Minipizzor", "Saft i f√§rgglada muggar"];
    } else if(place === 'Utomhus') {
      games = [
        { title: "Musikstafett", desc: "Spring till musiken!", instructions: "Lek stafett d√§r barnen springer n√§r musiken spelas och fryser n√§r den stannar.", props: "Bluetooth-h√∂gtalare" },
        { title: "S√•ngstafett", desc: "Spring och sjung!", instructions: "Dela in i lag, spring till en punkt och sjung en s√•ngrad.", props: "Ingen rekvisita" }
      ];
      menu = ["Picknickmackor", "Smoothies", "Fruktspett"];
    } else {
      games = [
        { title: "Disco i lokalen", desc: "Dansgolv med blinkande lampor!", instructions: "Sl√§ck ner, spela musik, dansa loss.", props: "Diskolampa, musik" },
        { title: "Limbo", desc: "Hur l√•gt kan du g√•?", instructions: "Anv√§nd ett sn√∂re, alla turas om.", props: "Sn√∂re" }
      ];
      menu = ["Pizza-bitar", "Glassbuff√©", "Saft"];
    }
    shopping = ["H√∂gtalare", "Musikspellista", "Mikrofon", "Ballonger", "T√•rta", "Servetter", "Dekorationer", "Presentp√•sar", "Kalashattar"];
  }
  else if(theme === 'fotboll') {
    if(place === 'Utomhus') {
      games = [
        { title: "Straffsparks-t√§vling", desc: "Vem s√§tter flest straffar?", instructions: "St√§ll upp m√•l, l√•t barnen skjuta straffar.", props: "Fotboll, m√•l" },
        { title: "Dribblingsbana", desc: "Snabbast genom konbanan vinner!", instructions: "Bygg bana med koner, tidtagning.", props: "Koner" }
      ];
      menu = ["Korv med br√∂d", "Sportdryck", "Frukt"];
    } else if(place === 'Hemma') {
      games = [
        { title: "Inomhus-fotboll", desc: "Mjuk fotboll p√• liten yta!", instructions: "Spela med mjuk boll, sm√• m√•l.", props: "Mjuk boll, tejpade m√•l" },
        { title: "Fotbollsbingo", desc: "Gissa resultat och vinn!", instructions: "L√•t barnen gissa utfall av sm√• matcher.", props: "Papper, pennor" }
      ];
      menu = ["Mini-pizzor", "Saft", "Fotbollst√•rta"];
    } else {
      games = [
        { title: "Bollstafett", desc: "Spring med boll p√• hinderbana!", instructions: "Balansera boll, spring bana.", props: "Bollar" }
      ];
      menu = ["T√•rta", "Saft", "Frukt"];
    }
    shopping = ["Fotboll", "M√•l", "Koner", "Visselpipa", "Ballonger", "T√•rta", "Servetter", "Dekorationer", "Presentp√•sar"];
  }
  else if(theme === 'prinsessa') {
    games = [
      { title: "Skattjakt i slottet", desc: "Leta efter g√∂mda skatter!", instructions: "G√∂m sm√• skatter, ge ledtr√•dar.", props: "Sm√• skatter, ledtr√•dar" },
      { title: "Krona-pyssel", desc: "Skapa egna prinsesskronor!", instructions: "Dela ut papper, glitter, lim.", props: "Papper, glitter, lim" }
    ];
    menu = ["Rosa cupcakes", "Prinsesst√•rta", "Saft i fina glas", "Jordgubbar"];
    shopping = ["Kronor", "Glitter", "Ballonger", "T√•rta", "Servetter", "Dekorationer", "Presentp√•sar", "Kalashattar"];
  }
  else if(theme === 'hastar') {
    games = [
      { title: "H√§stskor-kastning", desc: "Tr√§ffa m√•let med h√§stskor!", instructions: "St√§ll upp ringar, kasta h√§stskor.", props: "Plasth√§stskor, ringar" },
      { title: "Pinnt√§vling", desc: "Bygg egna k√§pph√§star och t√§vla!", instructions: "Pyssla k√§pph√§star, ha hinderbana.", props: "Pinnar, tyg, sn√∂re" }
    ];
    menu = ["Morotsstavar", "H√§stformade kakor", "Saft", "Sm√∂rg√•srullar"];
    shopping = ["K√§pph√§star", "Ballonger", "T√•rta", "Servetter", "Dekorationer", "Presentp√•sar", "Kalashattar"];
  }
  tips = [
    "Ha alltid en backup-lek om barnen tr√∂ttnar",
    "F√∂rbered lekar i tid ‚Äì helst dagen innan",
    "St√§da ytor som ska anv√§ndas",
    "Ha v√•tservetter och extra plastp√•sar redo"
  ];

  invite = `üéâ Du √§r bjuden p√• ${themeInfo[theme]?.name || theme}! üéâ

N√§r: [Datum och tid]
Var: ${place}
Vi firar ${age}-√•rsdagen med ${guests} barn, lekar, ${menu[0] ? menu[0].toLowerCase() : "gott fika"} och massor av kul!

OSA till [ditt namn/nummer]
V√§lkommen!`;

  return { games, menu, shopping, tips, invite };
}

function renderResult(main, state) {
  const themeObj = themeInfo[state.theme] || { name: state.theme, emoji: 'üéâ', description: '' };
  const data = getKalasData(state);
  main.innerHTML = `
    <section class="flex flex-col gap-6 fade-in">
      <div class="rounded-2xl bg-white shadow-kalas border-2 border-kalasmint flex flex-wrap items-center gap-4 px-6 py-4 justify-between">
        <div class="flex items-center gap-2 font-poppins text-lg">
          <span class="text-2xl">${themeObj.emoji}</span>
          <span><span class="font-semibold text-kalasblue">Tema:</span> ${themeObj.name}</span>
        </div>
        <div class="font-poppins text-lg"><span class="font-semibold text-kalasblue">√Ölder:</span> ${state.age} √•r</div>
        <div class="font-poppins text-lg"><span class="font-semibold text-kalasblue">Antal g√§ster:</span> ${state.guests} barn</div>
        <div class="font-poppins text-lg"><span class="font-semibold text-kalasblue">Plats:</span> ${state.place}</div>
      </div>
      <div class="rounded-2xl bg-kalasyellow/30 border-2 border-kalasyellow shadow p-4 flex items-center gap-4">
        <span class="text-3xl">${themeObj.emoji}</span>
        <div>
          <div class="font-poppins font-semibold text-kalasblue text-lg">${themeObj.name}</div>
          <div class="font-inter text-base text-kalasblue">${themeObj.description}</div>
        </div>
      </div>
      <div class="rounded-2xl bg-white shadow-kalas border-2 border-kalasyellow p-5">
        <h3 class="font-poppins text-xl text-kalascoral mb-2 flex items-center gap-2">üé≤ Lekar & aktiviteter</h3>
        <div class="flex flex-col gap-3">
          ${data.games.map(game => `
            <div class="bg-kalasmint/60 rounded-lg p-3 shadow">
              <div class="font-poppins font-semibold text-kalasblue">${game.title}</div>
              <div class="text-sm text-gray-700 mb-1">${game.desc}</div>
              <div class="text-xs text-gray-500">Instruktion: ${game.instructions}</div>
              <div class="text-xs text-gray-500">Rekvisita: ${game.props}</div>
            </div>
          `).join('')}
        </div>
      </div>
      <div class="rounded-2xl bg-white shadow-kalas border-2 border-kalasyellow p-5">
        <h3 class="font-poppins text-xl text-kalascoral mb-2 flex items-center gap-2">üç∞ Menyf√∂rslag</h3>
        <ul class="list-disc ml-5 text-gray-700">
          ${data.menu.map(item => `<li>${item}</li>`).join('')}
        </ul>
      </div>
      <div class="rounded-2xl bg-white shadow-kalas border-2 border-kalasyellow p-5">
        <h3 class="font-poppins text-xl text-kalascoral mb-2 flex items-center gap-2">üõí Ink√∂pslista</h3>
        <ul class="flex flex-col gap-1">
          ${data.shopping.map(item => `
            <li>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" class="kalas-checkbox accent-kalasyellow w-4 h-4 rounded" />
                <span class="transition">${item}</span>
              </label>
            </li>
          `).join('')}
        </ul>
      </div>
      <div class="rounded-2xl bg-white shadow-kalas border-2 border-kalasyellow p-5">
        <h3 class="font-poppins text-xl text-kalascoral mb-2 flex items-center gap-2">üìù Kom ih√•g!</h3>
        <ul class="list-disc ml-5 text-gray-700">
          ${data.tips.map(tip => `<li>${tip}</li>`).join('')}
        </ul>
      </div>
      <div class="rounded-2xl bg-white shadow-kalas border-2 border-kalasyellow p-5 flex flex-col gap-3">
        <h3 class="font-poppins text-xl text-kalascoral mb-2 flex items-center gap-2">üíå Inbjudningskort</h3>
        <div id="invite-text" class="kalas-invite font-inter text-kalasblue text-base mb-2">${data.invite.replace(/\n/g, "<br>")}</div>
        <div class="flex flex-wrap gap-2">
          <button class="kalas-btn bg-kalasyellow text-kalasblue px-4 py-2 rounded-full font-poppins font-semibold" onclick="copyInvite()">Kopiera</button>
          <a class="kalas-btn bg-kalasmint text-kalasblue px-4 py-2 rounded-full font-poppins font-semibold" href="mailto:?subject=Inbjudan till kalas!&body=${encodeURIComponent(data.invite)}">Maila</a>
          <a class="kalas-btn bg-kalascoral text-white px-4 py-2 rounded-full font-poppins font-semibold" href="sms:?body=${encodeURIComponent(data.invite)}">SMS</a>
        </div>
      </div>
      <div class="mt-2 flex flex-col items-center">
        <div class="font-poppins text-xl text-kalasblue mb-2">Ditt dr√∂mkalas √§r klart ‚Äì du √§r en kalasm√§stare! üéâ</div>
        <button id="start-over" class="kalas-btn px-6 py-2 rounded-full bg-kalasyellow text-kalasblue font-poppins font-semibold text-base shadow hover:bg-kalasmint transition mt-2">Planera nytt kalas</button>
      </div>
    </section>
  `;
  document.getElementById('start-over').onclick = () => {
    renderForm(document.getElementById('spa-content'));
  }
}

window.copyInvite = function() {
  const el = document.getElementById('invite-text');
  let text = el.innerText;
  navigator.clipboard.writeText(text);
  el.style.background = "#A8E6CF";
  setTimeout(()=>{el.style.background="#FAF7F2";}, 600);
}

renderForm(document.getElementById('spa-content'));
</script>
</body>
</html>
